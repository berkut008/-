{% extends "base.html" %}

{% block title %}–ü–æ–º–æ—â–Ω–∏–∫ ¬∑ Ollama{% endblock %}

{% block content %}
<style>
    body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        background: linear-gradient(-45deg, #003366, #004c99, #0073e6, #003366);
        background-size: 400% 400%;
        animation: gradientShift 10s ease infinite;
        font-family: "Segoe UI", sans-serif;
        color: #fff;
        position: relative;
        overflow-x: hidden;
    }

    body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            linear-gradient(90deg, transparent 95%, rgba(255,255,255,0.1) 100%),
            linear-gradient(0deg, transparent 95%, rgba(255,255,255,0.1) 100%),
            radial-gradient(circle at 20% 80%, rgba(255,255,255,0.05) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(255,255,255,0.05) 0%, transparent 50%);
        background-size: 50px 50px, 50px 50px, 500px 500px, 500px 500px;
        opacity: 0.4;
        pointer-events: none;
        z-index: 1;
    }

    @media (max-width: 768px) {
        body::before {
            background-size: 30px 30px, 30px 30px, 300px 300px, 300px 300px;
        }
    }

    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .top-line {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(255,255,255,0.6) 20%, 
            rgba(255,255,255,0.8) 50%, 
            rgba(255,255,255,0.6) 80%, 
            transparent 100%);
        z-index: 2;
    }

    .bottom-line {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(255,255,255,0.6) 20%, 
            rgba(255,255,255,0.8) 50%, 
            rgba(255,255,255,0.6) 80%, 
            transparent 100%);
        z-index: 2;
    }

    header {
        background: rgba(0, 0, 0, 0.25);
        backdrop-filter: blur(8px);
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        z-index: 3;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    header img {
        height: 50px;
        transition: transform 0.3s ease;
    }

    header img:hover {
        transform: scale(1.05);
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .header-title {
        color: white;
        font-weight: 600;
        font-size: 1.1rem;
        margin: 0;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .btn-nav {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 0.5rem 1.5rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-nav:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .main-content {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
        z-index: 3;
        margin-top: 20px;
        margin-bottom: 60px;
    }

    .dashboard-container {
        width: 100%;
        max-width: 1000px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        color: #000;
        animation: fadeIn 0.8s ease;
        border: 1px solid rgba(255, 255, 255, 0.3);
        position: relative;
        z-index: 4;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .form-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid rgba(0, 51, 102, 0.2);
        position: relative;
    }

    .form-header::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 25%;
        right: 25%;
        height: 2px;
        background: linear-gradient(90deg, 
            transparent 0%, 
            #003366 20%, 
            #0073e6 50%, 
            #003366 80%, 
            transparent 100%);
        z-index: 1;
    }

    .form-title {
        color: #003366;
        font-weight: 700;
        margin-bottom: 1rem;
        font-size: 1.8rem;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .form-subtitle {
        color: #666;
        font-size: 1rem;
        max-width: 500px;
        margin: 0 auto;
    }

    .form-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 51, 102, 0.1);
        position: relative;
        overflow: hidden;
        margin-bottom: 1.5rem;
        animation: slideInUp 0.6s ease;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .form-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, 
            #003366 0%, 
            #0073e6 50%, 
            #003366 100%);
        z-index: 1;
    }

    .status-online {
        width: 14px;
        height: 14px;
        background: #00ff9d;
        border-radius: 50%;
        box-shadow: 0 0 10px #00ff9d;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(0, 255, 157, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(0, 255, 157, 0); }
        100% { box-shadow: 0 0 0 0 rgba(0, 255, 157, 0); }
    }

    .form-control {
        border-radius: 12px;
        padding: 14px;
        font-size: 1.1rem;
        border: 2px solid rgba(0, 51, 102, 0.2);
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.95);
    }

    .form-control:focus {
        border-color: #0073e6;
        box-shadow: 0 0 0 0.25rem rgba(0, 115, 230, 0.25);
        transform: translateY(-2px);
    }

    .btn-primary {
        background: linear-gradient(135deg, #003366, #0073e6);
        border: none;
        padding: 14px;
        font-size: 1.1rem;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 51, 102, 0.4);
        background: linear-gradient(135deg, #0073e6, #003366);
    }

    .btn-primary:disabled {
        background: linear-gradient(135deg, #6c757d, #495057);
        transform: none;
        box-shadow: none;
    }

    .response-box {
        background: white;
        border-radius: 15px;
        padding: 1.8rem;
        margin-top: 1.5rem;
        border-left: 5px solid #003366;
        white-space: pre-wrap;
        animation: fadeIn 0.5s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        position: relative;
        overflow: hidden;
    }

    .response-box::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, 
            transparent 0%, 
            #003366 20%, 
            #0073e6 50%, 
            #003366 80%, 
            transparent 100%);
    }

    .alert {
        border-radius: 10px;
        border: none;
        margin-bottom: 1.5rem;
        animation: fadeIn 0.5s ease;
    }

    .alert-success {
        background: rgba(76, 175, 80, 0.1);
        color: #2e7d32;
        border-left: 4px solid #4caf50;
    }

    .alert-danger {
        background: rgba(244, 67, 54, 0.1);
        color: #c62828;
        border-left: 4px solid #f44336;
    }

    .alert-warning {
        background: rgba(255, 152, 0, 0.1);
        color: #ef6c00;
        border-left: 4px solid #ff9800;
    }

    .alert-info {
        background: rgba(33, 150, 243, 0.1);
        color: #1565c0;
        border-left: 4px solid #2196f3;
    }

    .icon {
        font-size: 1.2rem;
    }

    .action-buttons-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 2px solid rgba(0, 51, 102, 0.1);
    }

    .left-button {
        display: flex;
        justify-content: flex-start;
        flex: 1;
    }

    .right-buttons {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        flex-wrap: wrap;
    }

    .btn-action {
        background: linear-gradient(135deg, #003366, #0073e6);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        border-radius: 10px;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        text-decoration: none;
        text-align: center;
        min-width: 180px;
        justify-content: center;
    }

    .btn-action:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 51, 102, 0.4);
        background: linear-gradient(135deg, #0073e6, #003366);
        color: white;
        text-decoration: none;
    }

    .btn-action:active {
        transform: translateY(-1px);
    }

    .btn-export {
        background: linear-gradient(135deg, #20c997, #198754);
    }

    .btn-export:hover {
        background: linear-gradient(135deg, #198754, #20c997);
    }

    .btn-back {
        background: linear-gradient(135deg, #6c757d, #495057);
    }

    .btn-back:hover {
        background: linear-gradient(135deg, #495057, #6c757d);
    }

    .footer {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        text-align: center;
        padding: 20px;
        width: 100%;
        background: rgba(0, 0, 0, 0.2);
        margin-top: auto;
        position: relative;
        z-index: 3;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .footer-text {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
    }

    .summary-card {
        background: linear-gradient(135deg, #003366, #0073e6);
        color: white;
        padding: 1.5rem;
        border-radius: 15px;
        margin-bottom: 2rem;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 51, 102, 0.3);
        animation: fadeIn 0.6s ease;
    }

    .summary-card h5 {
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .summary-stats {
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
        gap: 15px;
    }

    .summary-item {
        text-align: center;
        animation: fadeIn 0.8s ease;
    }

    .summary-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 5px;
    }

    .summary-label {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @media (max-width: 768px) {
        .dashboard-container {
            padding: 1.5rem;
            margin: 1rem;
        }
        
        header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
            padding: 1rem;
        }
        
        .logo-container {
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .header-actions {
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .form-card {
            padding: 1.5rem;
        }
        
        .form-title {
            font-size: 1.5rem;
        }
        
        .summary-stats {
            gap: 10px;
        }
        
        .summary-value {
            font-size: 1.5rem;
        }
        
        .action-buttons-container {
            flex-direction: column;
            gap: 1rem;
        }
        
        .left-button, .right-buttons {
            width: 100%;
            justify-content: center;
        }
        
        .btn-action {
            width: 100%;
            min-width: auto;
        }
    }

    @media (max-width: 576px) {
        .right-buttons {
            flex-direction: column;
            width: 100%;
        }
        
        .btn-action {
            width: 100%;
        }
    }
</style>

<!-- –í–µ—Ä—Ö–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è -->
<div class="top-line"></div>

<!-- –®–∞–ø–∫–∞ -->
<header>
    <div class="logo-container">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="–†–ò–ù–•">
        <h5 class="header-title">–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ (–†–ò–ù–•)</h5>
    </div>
    <div class="header-actions">
        <a href="{{ url_for('auth.logout') }}" class="btn-nav">
            <span class="icon"></span>
            –í—ã–π—Ç–∏
        </a>
    </div>
</header>

<!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
<div class="main-content">
    <div class="dashboard-container">
        <div class="form-header">
            <h1 class="form-title">
                ü§ñ –ü–æ–º–æ—â–Ω–∏–∫ (–ª–æ–∫–∞–ª—å–Ω—ã–π Ollama)
            </h1>
            <p class="form-subtitle">
                –õ–æ–∫–∞–ª—å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –¥–ª—è –ø–æ–º–æ—â–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å —Å–∏—Å—Ç–µ–º–æ–π
            </p>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, msg in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        <div class="d-flex align-items-center">
                            <span class="icon me-2">
                                {% if category == 'success' %}‚úÖ
                                {% elif category == 'danger' %}‚ùå
                                {% elif category == 'warning' %}‚ö†Ô∏è
                                {% else %}‚ÑπÔ∏è
                                {% endif %}
                            </span>
                            <div>{{ msg }}</div>
                            <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="form-card">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ -->
            <div class="summary-card">
                <h5>üìä –°—Ç–∞—Ç—É—Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞</h5>
                <div class="summary-stats">
                    <div class="summary-item">
                        <div class="summary-value">
                            <div class="status-online" style="display: inline-block; vertical-align: middle;"></div>
                            {% if use_ollama %}<span style="margin-left: 10px;">ONLINE</span>{% else %}<span style="margin-left: 10px;">OFFLINE</span>{% endif %}
                        </div>
                        <div class="summary-label">–°—Ç–∞—Ç—É—Å</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">{{ current_model if use_ollama else '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–∞' }}</div>
                        <div class="summary-label">–ú–æ–¥–µ–ª—å</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">127.0.0.1:11434</div>
                        <div class="summary-label">–ê–¥—Ä–µ—Å</div>
                    </div>
                </div>
            </div>

            {% if use_ollama %}
                <p class="text-muted mb-4" style="color: #666; font-weight: 500;">
                    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å: <strong style="color: #003366;">{{ current_model }}</strong>
                </p>
            {% else %}
                <div class="alert alert-info">
                    <div class="d-flex align-items-center">
                        <span class="icon me-2">‚ÑπÔ∏è</span>
                        <div>–õ–æ–∫–∞–ª—å–Ω—ã–π –ò–ò <strong>–æ—Ç–∫–ª—é—á—ë–Ω</strong> (USE_OLLAMA=false)</div>
                    </div>
                </div>
            {% endif %}

            <form method="POST" class="mb-4">
                <div class="mb-3">
                    <label for="question" class="form-label fs-5" style="color: #003366; font-weight: 600;">
                        –í–∞—à –≤–æ–ø—Ä–æ—Å:
                    </label>
                    <textarea 
                        name="question" 
                        class="form-control" 
                        rows="5" 
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç—É? –ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≥—Ä—É–ø–ø—ã? –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤?"
                        required>{{ question }}</textarea>
                </div>

                <button type="submit" class="btn btn-primary w-100 py-3" {% if not use_ollama %}disabled{% endif %}>
                    <span class="icon">üöÄ</span> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
                </button>
            </form>

            {% if answer %}
            <div class="response-box">
                <div class="d-flex align-items-center mb-3">
                    <div class="status-online me-2"></div>
                    <h5 style="color: #003366; margin: 0; font-weight: 600;">
                        –û—Ç–≤–µ—Ç –ø–æ–º–æ—â–Ω–∏–∫–∞:
                    </h5>
                </div>
                <div style="white-space: pre-wrap; line-height: 1.6; color: #333; font-size: 1.05rem;">{{ answer }}</div>
                <div class="mt-3 pt-3 border-top text-muted small">
                    <span class="icon">‚è±Ô∏è</span> –û—Ç–≤–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ
                </div>
            </div>
            {% endif %}

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }} mt-3">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="action-buttons-container">
            <div class="left-button">
                <a href="{{ url_for('dashboard.index') }}" class="btn-action btn-back">
                    <span class="icon">‚¨Ö</span>
                    –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å
                </a>
            </div>
            <div class="right-buttons">
                {% if answer %}
                <button type="button" class="btn-action btn-export" onclick="copyAnswer()">
                    <span class="icon">üìã</span>
                    –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
                </button>
                {% endif %}
                <a href="{{ url_for('ollama.ai_assistant') }}" class="btn-action">
                    <span class="icon">ü§ñ</span>
                    –ò–ò –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞
                </a>
            </div>
        </div>
    </div>
</div>

<!-- –ù–∏–∂–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è -->
<div class="bottom-line"></div>

<!-- –§—É—Ç–µ—Ä -->
<div class="footer">
    <div class="footer-text">
        ¬© 2025–≥. –§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ (–†–ò–ù–•) ‚Ä¢ –õ–æ–∫–∞–ª—å–Ω—ã–π AI –ø–æ–º–æ—â–Ω–∏–∫
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
        const dashboardContainer = document.querySelector('.dashboard-container');
        dashboardContainer.style.opacity = '0';
        dashboardContainer.style.transform = 'translateY(30px) scale(0.95)';
        
        setTimeout(() => {
            dashboardContainer.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
            dashboardContainer.style.opacity = '1';
            dashboardContainer.style.transform = 'translateY(0) scale(1)';
        }, 200);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        const summaryItems = document.querySelectorAll('.summary-item');
        summaryItems.forEach((item, index) => {
            item.style.opacity = '0';
            item.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                item.style.transition = 'all 0.5s ease';
                item.style.opacity = '1';
                item.style.transform = 'translateY(0)';
            }, 400 + (index * 100));
        });
        
        // –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        const formCard = document.querySelector('.form-card');
        if (formCard) {
            formCard.style.opacity = '0';
            formCard.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                formCard.style.transition = 'all 0.5s ease 0.3s';
                formCard.style.opacity = '1';
                formCard.style.transform = 'translateY(0)';
            }, 300);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
        const submitBtn = document.querySelector('.btn-primary');
        if (submitBtn) {
            submitBtn.style.opacity = '0';
            submitBtn.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                submitBtn.style.transition = 'all 0.5s ease 0.5s';
                submitBtn.style.opacity = '1';
                submitBtn.style.transform = 'translateY(0)';
            }, 500);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–∏
        const responseBox = document.querySelector('.response-box');
        if (responseBox) {
            responseBox.style.opacity = '0';
            responseBox.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                responseBox.style.transition = 'all 0.5s ease 0.7s';
                responseBox.style.opacity = '1';
                responseBox.style.transform = 'translateY(0)';
            }, 700);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
        const buttons = document.querySelectorAll('.btn-action');
        buttons.forEach((btn, index) => {
            btn.style.opacity = '0';
            btn.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                btn.style.transition = 'all 0.5s ease';
                btn.style.opacity = '1';
                btn.style.transform = 'translateY(0)';
            }, 800 + (index * 100));
        });
    });
    
    // –§—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
    function copyAnswer() {
        const responseBox = document.querySelector('.response-box');
        if (responseBox) {
            const answerText = responseBox.innerText;
            navigator.clipboard.writeText(answerText).then(() => {
                showAlert('–û—Ç–≤–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }).catch(err => {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
                showAlert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç', 'danger');
            });
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showAlert(message, type = 'info') {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
        alertDiv.innerHTML = `
            <div class="d-flex align-items-center">
                <span class="icon me-2">${type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}</span>
                <div>${message}</div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
            </div>
        `;
        
        // –í—Å—Ç–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–æ–π
        const formCard = document.querySelector('.form-card');
        formCard.parentNode.insertBefore(alertDiv, formCard);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
        setTimeout(() => {
            if (alertDiv.parentNode) {
                const bsAlert = new bootstrap.Alert(alertDiv);
                bsAlert.close();
            }
        }, 5000);
    }
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
    document.addEventListener('focusin', function(e) {
        if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') {
            e.target.style.boxShadow = '0 0 0 3px rgba(0, 115, 230, 0.3)';
            e.target.style.transform = 'translateY(-2px)';
        }
    });
    
    document.addEventListener('focusout', function(e) {
        if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') {
            e.target.style.boxShadow = '';
            e.target.style.transform = 'translateY(0)';
        }
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏
    document.querySelectorAll('.btn-action, .btn-primary').forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-3px)';
        });
        
        btn.addEventListener('mouseleave', function() {
            if (!this.classList.contains('hover')) {
                this.style.transform = 'translateY(0)';
            }
        });
    });
</script>
{% endblock %}