<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–æ–ø—É—Å–∫–∏ | –§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ (–†–ò–ù–•)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ –∂–µ, —á—Ç–æ –≤ –≤–∞—à–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ */
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: linear-gradient(-45deg, #003366, #004c99, #0073e6, #003366);
      background-size: 400% 400%;
      animation: gradientShift 10s ease infinite;
      font-family: "Segoe UI", sans-serif;
      color: #fff;
      position: relative;
      overflow-x: hidden;
    }

    /* –õ–∏–Ω–∏–∏ –Ω–∞ –∑–∞–¥–Ω–µ–º —Ñ–æ–Ω–µ */
    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
          linear-gradient(90deg, transparent 95%, rgba(255,255,255,0.1) 100%),
          linear-gradient(0deg, transparent 95%, rgba(255,255,255,0.1) 100%);
      background-size: 50px 50px;
      opacity: 0.4;
      pointer-events: none;
      z-index: 1;
    }

    /* –í–µ—Ä—Ö–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è */
    .top-line {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, 
          transparent 0%, 
          rgba(255,255,255,0.6) 20%, 
          rgba(255,255,255,0.8) 50%, 
          rgba(255,255,255,0.6) 80%, 
          transparent 100%);
      z-index: 2;
    }

    /* –ù–∏–∂–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è */
    .bottom-line {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, 
          transparent 0%, 
          rgba(255,255,255,0.6) 20%, 
          rgba(255,255,255,0.8) 50%, 
          rgba(255,255,255,0.6) 80%, 
          transparent 100%);
      z-index: 2;
    }

    header {
      background: rgba(0, 0, 0, 0.25);
      backdrop-filter: blur(8px);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 3;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    header img {
      height: 50px;
      transition: transform 0.3s ease;
    }

    header img:hover {
      transform: scale(1.05);
    }

    .main-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      width: 100%;
      padding: 20px;
      position: relative;
      z-index: 3;
    }

    .container-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
      color: #000;
      width: 100%;
      max-width: 1200px;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.3);
      animation: fadeIn 0.6s ease;
      margin-bottom: 30px;
    }

    /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ */
    .container-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, 
          #003366 0%, 
          #0073e6 50%, 
          #003366 100%);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h3 {
      font-weight: 600;
      color: #003366;
      position: relative;
      padding-bottom: 10px;
    }

    h3::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, 
          transparent 0%, 
          #003366 20%, 
          #0073e6 50%, 
          #003366 80%, 
          transparent 100%);
    }

    .btn-primary {
      background-color: #003366;
      border: none;
      transition: all 0.3s ease;
      border-radius: 8px;
      padding: 10px 20px;
    }

    .btn-primary:hover {
      background-color: #0073e6;
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(0, 115, 230, 0.4);
    }

    .btn-outline-secondary {
      border: 1px solid #003366;
      color: #003366;
      border-radius: 8px;
      padding: 10px 20px;
      transition: all 0.3s ease;
    }

    .btn-outline-secondary:hover {
      background-color: #003366;
      color: white;
      transform: scale(1.05);
    }

    table thead {
      background: linear-gradient(90deg, #003366, #0073e6);
      color: white;
    }

    .table th {
      border-bottom: 2px solid #003366;
    }

    .table tbody tr:hover {
      background-color: rgba(0, 51, 102, 0.05);
      transition: background-color 0.2s ease;
    }

    .footer {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.9rem;
      text-align: center;
      padding: 20px;
      width: 100%;
      background: rgba(0, 0, 0, 0.2);
      margin-top: auto;
      position: relative;
      z-index: 3;
    }

    .btn-sm {
      font-size: 0.85rem;
      border-radius: 6px;
      padding: 5px 10px;
      transition: all 0.3s ease;
    }

    .btn-outline-primary {
      border: 1px solid #003366;
      color: #003366;
    }

    .btn-outline-primary:hover {
      background-color: #003366;
      color: white;
      transform: scale(1.05);
    }

    .btn-danger {
      background-color: #dc3545;
      border: none;
    }

    .btn-danger:hover {
      background-color: #c82333;
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(220, 53, 69, 0.4);
    }

    .alert {
      border-radius: 10px;
      border: none;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .header-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π */
    .actions-column {
      text-align: right;
      white-space: nowrap;
    }

    .actions-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      align-items: center;
    }

    /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–æ–ª–±—Ü–∞ —Ç–æ–∂–µ –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
    .table thead th:last-child {
      text-align: right;
    }

    /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
    .table-responsive {
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(0, 51, 102, 0.1);
    }

    .table {
      margin-bottom: 0;
    }

    .table td, .table th {
      padding: 12px 15px;
      vertical-align: middle;
    }

    .table td {
      border-top: 1px solid rgba(0, 51, 102, 0.1);
    }

    .no-data {
      text-align: center;
      padding: 40px !important;
      color: #666;
      font-size: 1.1rem;
    }

    .badge-count {
      background: #0073e6;
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      margin-right: 8px;
    }

    .date-cell {
      white-space: nowrap;
      font-family: monospace;
      font-weight: 500;
    }

    .reason-cell {
      max-width: 250px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .reason-cell:hover {
      overflow: visible;
      white-space: normal;
      position: relative;
      z-index: 2;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 8px;
      border-radius: 6px;
      max-width: 400px;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –±–µ–π–¥–∂–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
    .user-role-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-left: 10px;
      vertical-align: middle;
    }
    
    .user-role-badge.admin {
      background: linear-gradient(135deg, #6c757d, #495057);
      color: white;
    }
    
    .user-role-badge.curator {
      background: linear-gradient(135deg, #6f42c1, #5a32a3);
      color: white;
    }
    
    .user-role-badge.leader {
      background: linear-gradient(135deg, #20c997, #17a589);
      color: white;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞ */
    .access-notice {
      background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.2));
      border-left: 4px solid #ffc107;
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.95rem;
    }

    /* –°—Ç–∏–ª—å –¥–ª—è –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ */
    .student-name-cell {
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .student-name-cell:hover {
      color: #0073e6;
      text-decoration: underline;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
    .student-modal-img {
      font-size: 4rem;
      color: #0073e6;
      margin-bottom: 1rem;
    }

    /* –°—Ç–∏–ª—å –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
    .btn-disabled-custom {
      background-color: #e9ecef;
      border-color: #ced4da;
      color: #6c757d;
      cursor: not-allowed;
      opacity: 0.65;
    }

    .btn-disabled-custom:hover {
      background-color: #e9ecef;
      border-color: #ced4da;
      color: #6c757d;
      transform: none;
      box-shadow: none;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 768px) {
      .container-card {
        padding: 1.5rem;
        margin: 1rem;
      }
      
      header {
        flex-direction: column;
        gap: 1rem;
        padding: 1rem;
        text-align: center;
      }
      
      .header-buttons {
        justify-content: center;
        flex-direction: column;
        width: 100%;
      }
      
      .header-buttons .btn {
        width: 100%;
        margin-bottom: 5px;
      }
      
      .actions-buttons {
        flex-direction: column;
        gap: 5px;
      }
      
      .actions-buttons .btn {
        width: 100%;
        text-align: center;
      }
      
      .table-responsive {
        font-size: 0.9rem;
      }
      
      .table td, .table th {
        padding: 8px 10px;
      }
    }

    @media (max-width: 576px) {
      .container-card {
        padding: 1rem;
      }
      
      h3 {
        font-size: 1.3rem;
      }
      
      .table-responsive {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>

  <!-- –í–µ—Ä—Ö–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è -->
  <div class="top-line"></div>

  <header>
    <div class="d-flex align-items-center gap-2">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="–†–ò–ù–•">
        <h5 class="m-0">–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ (–†–ò–ù–•)</h5>
    </div>
    <div class="d-flex align-items-center gap-3">
      <span class="text-white">
        {{ current_user.full_name }}
        <span class="user-role-badge {{ current_user.role }}">
          {% if current_user.role == 'admin' %}
            –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
          {% elif current_user.role == 'curator' %}
            –ö—É—Ä–∞—Ç–æ—Ä
          {% else %}
            –°—Ç–∞—Ä–æ—Å—Ç–∞
          {% endif %}
        </span>
      </span>
      <a href="{{ url_for('auth.logout') }}" class="btn btn-light">–í—ã–π—Ç–∏</a>
    </div>
  </header>

  <div class="main-container">
    <div class="container-card">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>üìã –°–ø–∏—Å–æ–∫ –ø—Ä–æ–ø—É—Å–∫–æ–≤</h3>
        <div class="header-buttons">
          <!-- –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫" –≤–∏–¥–Ω–∞ –í–°–ï–ú —Ä–æ–ª—è–º -->
          <a href="{{ url_for('dashboard.add_absence') }}" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫</a>
          <a href="{{ url_for('dashboard.index') }}" class="btn btn-outline-secondary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </div>
      </div>

      <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞ -->
      <div class="access-notice mb-4">
        <strong>‚ö†Ô∏è –í–∞—à–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:</strong>
        {% if current_user.role == 'admin' %}
          –í—ã –∏–º–µ–µ—Ç–µ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø: –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏.
        {% elif current_user.role == 'curator' %}
          –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å –∏—Ö (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä).
        {% else %}
          –í—ã –º–æ–∂–µ—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –∫—É—Ä–∞—Ç–æ—Ä–∞–º –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.
        {% endif %}
      </div>

      <!-- –§–ª–µ—à-—Å–æ–æ–±—â–µ–Ω–∏—è -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, msg in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show mb-4" role="alert">
              <div class="d-flex align-items-center">
                {% if category == 'success' %}
                  <span class="me-2">‚úÖ</span>
                {% elif category == 'danger' %}
                  <span class="me-2">‚ùå</span>
                {% elif category == 'warning' %}
                  <span class="me-2">‚ö†Ô∏è</span>
                {% else %}
                  <span class="me-2">‚ÑπÔ∏è</span>
                {% endif %}
                <div>{{ msg }}</div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
              </div>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="text-muted">
          {% if absences %}
            <span class="badge bg-primary rounded-pill">{{ absences|length }}</span> –∑–∞–ø–∏—Å–µ–π
          {% else %}
            –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –ø—Ä–æ–ø—É—Å–∫–∞—Ö
          {% endif %}
        </div>
        <div>
          <small class="text-muted">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {{ now.strftime('%d.%m.%Y %H:%M') if now else '' }}</small>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
          <thead>
            <tr>
              <th width="50">#</th>
              <th>–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞</th>
              <th width="120">–ì—Ä—É–ø–ø–∞</th>
              <th width="120">–î–∞—Ç–∞</th>
              <th>–ü—Ä–∏—á–∏–Ω–∞</th>
              <th width="200" class="text-end">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            {% if absences %}
              {% for a in absences %}
              <tr>
                <td>
                  <span class="badge-count">{{ loop.index }}</span>
                </td>
                <td>
                  <strong class="student-name-cell" onclick="showStudentDetails({{ a.student.id }}, '{{ a.student.full_name }}')">
                    {{ a.student.full_name }}
                  </strong>
                </td>
                <td>
                  <span class="badge bg-info text-dark">{{ a.student.group.name if a.student.group else '-' }}</span>
                </td>
                <td class="date-cell">
                  {{ a.date.strftime('%d.%m.%Y') }}
                </td>
                <td class="reason-cell" title="{{ a.reason or '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}">
                  {% if a.reason %}
                    {{ a.reason }}
                  {% else %}
                    <span class="text-muted">-</span>
                  {% endif %}
                </td>
                <td class="actions-column">
                  <div class="actions-buttons">
                    <!-- –ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê–ú –∏ –ö–£–†–ê–¢–û–†–ê–ú -->
                    {% if current_user.role in ['admin', 'curator'] %}
                      <a href="{{ url_for('dashboard.edit_absence', absence_id=a.id) }}" class="btn btn-sm btn-outline-primary">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                      </a>
                    {% else %}
                      <!-- –î–ª—è —Å—Ç–∞—Ä–æ—Å—Ç—ã –∫–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∫—Ä—ã—Ç–∞ –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ -->
                      <button class="btn btn-sm btn-disabled-custom" disabled title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä–∞–º –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                      </button>
                    {% endif %}
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å" –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê–ú -->
                    {% if current_user.role == 'admin' %}
                      <form method="POST" action="{{ url_for('dashboard.delete_absence', absence_id=a.id) }}"
                            style="display:inline-block"
                            onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–∞ {{ a.student.full_name }} –æ—Ç {{ a.date.strftime("%d.%m.%Y") }}?');">
                        <button class="btn btn-sm btn-danger">üóë –£–¥–∞–ª–∏—Ç—å</button>
                      </form>
                    {% else %}
                      <!-- –î–ª—è –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Å—Ç–∞—Ä–æ—Å—Ç –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–∫—Ä—ã—Ç–∞ –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ -->
                      <button class="btn btn-sm btn-disabled-custom" disabled title="–£–¥–∞–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º">
                        üóë –£–¥–∞–ª–∏—Ç—å
                      </button>
                    {% endif %}
                  </div>
                </td>
              </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="6" class="no-data">
                  <div class="py-4">
                    <div class="mb-3">
                      <span style="font-size: 2rem;">üì≠</span>
                    </div>
                    <h5 class="text-muted mb-2">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –ø—Ä–æ–ø—É—Å–∫–∞—Ö</h5>
                    <p class="text-muted mb-3">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –ø—Ä–æ–ø—É—Å–∫, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫"</p>
                    <a href="{{ url_for('dashboard.add_absence') }}" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫</a>
                  </div>
                </td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>

      <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ) -->
      {% if absences and absences|length > 10 %}
      <div class="d-flex justify-content-between align-items-center mt-4">
        <div class="text-muted">
          –ü–æ–∫–∞–∑–∞–Ω–æ {{ absences|length }} –∏–∑ {{ total_count if total_count else absences|length }} –∑–∞–ø–∏—Å–µ–π
        </div>
        <nav>
          <ul class="pagination mb-0">
            <li class="page-item disabled">
              <a class="page-link" href="#">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
            </li>
            <li class="page-item active">
              <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">3</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">–°–ª–µ–¥—É—é—â–∞—è</a>
            </li>
          </ul>
        </nav>
      </div>
      {% endif %}

      <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
      {% if absences %}
      <div class="mt-4 pt-3 border-top">
        <div class="d-flex justify-content-between align-items-center">
          <small class="text-muted">
            <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
          </small>
          <div class="d-flex gap-2">
            <button class="btn btn-sm btn-info" onclick="showAccessTable()">
              ‚ùì –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
            </button>
            <button class="btn btn-sm btn-outline-secondary" onclick="window.print()">
              üñ®Ô∏è –ü–µ—á–∞—Ç—å
            </button>
            <button class="btn btn-sm btn-outline-secondary" onclick="exportToCSV()">
              üì• –≠–∫—Å–ø–æ—Ä—Ç CSV
            </button>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- –ù–∏–∂–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è -->
  <div class="bottom-line"></div>

  <div class="footer">
    ¬© 2025–≥. –§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ (–†–ò–ù–•)
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
    document.addEventListener('DOMContentLoaded', function() {
      const containerCard = document.querySelector('.container-card');
      containerCard.style.opacity = '0';
      containerCard.style.transform = 'translateY(30px) scale(0.95)';
      
      setTimeout(() => {
        containerCard.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
        containerCard.style.opacity = '1';
        containerCard.style.transform = 'translateY(0) scale(1)';
      }, 200);
      
      // –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
      const tableRows = document.querySelectorAll('tbody tr');
      tableRows.forEach((row, index) => {
        row.style.opacity = '0';
        row.style.transform = 'translateX(-20px)';
        
        setTimeout(() => {
          row.style.transition = 'all 0.5s ease';
          row.style.opacity = '1';
          row.style.transform = 'translateX(0)';
        }, 300 + (index * 100));
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞
      showAccessInfo();
    });
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞
    function showAccessInfo() {
      const userRole = '{{ current_user.role }}';
      let message = '';
      
      if (userRole === 'admin') {
        message = '–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –£ –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏.';
      } else if (userRole === 'curator') {
        message = '–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∫—É—Ä–∞—Ç–æ—Ä. –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å –∏—Ö.';
      } else {
        message = '–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ —Å—Ç–∞—Ä–æ—Å—Ç–∞. –í—ã –º–æ–∂–µ—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏.';
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
      if (!sessionStorage.getItem('accessInfoShown')) {
        setTimeout(() => {
          showAlert(message, 'info');
          sessionStorage.setItem('accessInfoShown', 'true');
        }, 1000);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –¥–µ—Ç–∞–ª–µ–π —Å—Ç—É–¥–µ–Ω—Ç–∞
    function showStudentDetails(studentId, studentName) {
      // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—É–¥–µ–Ω—Ç–µ
      const modalHtml = `
        <div class="modal fade" id="studentModal" tabindex="-1" aria-labelledby="studentModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="studentModalLabel">üë®‚Äçüéì –î–µ—Ç–∞–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="text-center mb-4">
                  <div class="student-modal-img">üë®‚Äçüéì</div>
                  <h4>${studentName}</h4>
                  <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–µ...</p>
                </div>
                <div class="text-center">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                {% if current_user.role in ['admin', 'curator'] %}
                  <a href="/dashboard/edit_student/${studentId}" class="btn btn-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</a>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      `;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤ DOM
      const modalContainer = document.createElement('div');
      modalContainer.innerHTML = modalHtml;
      document.body.appendChild(modalContainer);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
      const modal = new bootstrap.Modal(document.getElementById('studentModal'));
      modal.show();
      
      // –£–¥–∞–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è
      document.getElementById('studentModal').addEventListener('hidden.bs.modal', function () {
        modalContainer.remove();
      });
      
      // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–µ
      setTimeout(() => {
        const modalBody = document.querySelector('#studentModal .modal-body');
        modalBody.innerHTML = `
          <div class="row">
            <div class="col-md-4 text-center">
              <div class="student-modal-img">üë®‚Äçüéì</div>
              <h4>${studentName}</h4>
              <p class="text-muted">–°—Ç—É–¥–µ–Ω—Ç</p>
              <div class="mt-3">
                <span class="badge bg-primary">ID: ${studentId}</span>
              </div>
            </div>
            <div class="col-md-8">
              <h5>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–µ</h5>
              <table class="table table-bordered">
                <tr>
                  <th width="40%">–ü–æ–ª–Ω–æ–µ –∏–º—è:</th>
                  <td>${studentName}</td>
                </tr>
                <tr>
                  <th>ID —Å—Ç—É–¥–µ–Ω—Ç–∞:</th>
                  <td>${studentId}</td>
                </tr>
                <tr>
                  <th>–°—Ç–∞—Ç—É—Å:</th>
                  <td><span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span></td>
                </tr>
                <tr>
                  <th>–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</th>
                  <td>${new Date().toLocaleDateString('ru-RU')}</td>
                </tr>
              </table>
              
              <h5 class="mt-4">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤</h5>
              <div class="row text-center">
                <div class="col-4">
                  <div class="card bg-light">
                    <div class="card-body">
                      <h2 class="text-primary" id="total-absences">0</h2>
                      <small>–í—Å–µ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤</small>
                    </div>
                  </div>
                </div>
                <div class="col-4">
                  <div class="card bg-light">
                    <div class="card-body">
                      <h2 class="text-success" id="valid-absences">0</h2>
                      <small>–£–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã—Ö</small>
                    </div>
                  </div>
                </div>
                <div class="col-4">
                  <div class="card bg-light">
                    <div class="card-body">
                      <h2 class="text-danger" id="invalid-absences">0</h2>
                      <small>–ù–µ—É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã—Ö</small>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="mt-4">
                <h5>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∏</h5>
                <div class="table-responsive">
                  <table class="table table-sm">
                    <thead>
                      <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–ü—Ä–∏—á–∏–Ω–∞</th>
                      </tr>
                    </thead>
                    <tbody id="recent-absences">
                      <tr>
                        <td colspan="2" class="text-center text-muted">
                          <div class="spinner-border spinner-border-sm" role="status">
                            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                          </div>
                          –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        `;
        
        // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–ø—É—Å–∫–∞—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞
        simulateStudentData(studentId);
      }, 800);
    }
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ —Å—Ç—É–¥–µ–Ω—Ç–µ
    function simulateStudentData(studentId) {
      setTimeout(() => {
        // –ò–º–∏—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–ø—É—Å–∫–∞—Ö
        const totalAbsences = Math.floor(Math.random() * 10);
        const validAbsences = Math.floor(totalAbsences * 0.6);
        const invalidAbsences = totalAbsences - validAbsences;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        document.getElementById('total-absences').textContent = totalAbsences;
        document.getElementById('valid-absences').textContent = validAbsences;
        document.getElementById('invalid-absences').textContent = invalidAbsences;
        
        // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∏
        const recentAbsences = [
          { date: '10.05.2025', reason: '–ë–æ–ª–µ–∑–Ω—å' },
          { date: '05.05.2025', reason: '–°–µ–º–µ–π–Ω—ã–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞' },
          { date: '28.04.2025', reason: '–ü–æ—Å–µ—â–µ–Ω–∏–µ –≤—Ä–∞—á–∞' }
        ];
        
        const recentTable = document.getElementById('recent-absences');
        recentTable.innerHTML = '';
        
        if (totalAbsences > 0) {
          recentAbsences.forEach(abs => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${abs.date}</td>
              <td>${abs.reason}</td>
            `;
            recentTable.appendChild(row);
          });
        } else {
          recentTable.innerHTML = `
            <tr>
              <td colspan="2" class="text-center text-muted">
                –ù–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∑–∞ —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥
              </td>
            </tr>
          `;
        }
      }, 1000);
    }
    
    // –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
    function exportToCSV() {
      const rows = document.querySelectorAll('tbody tr:not(.no-data)');
      if (rows.length === 0) {
        alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
        return;
      }
      
      let csv = '‚Ññ,–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞,–ì—Ä—É–ø–ø–∞,–î–∞—Ç–∞,–ü—Ä–∏—á–∏–Ω–∞\n';
      
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const rowData = [
          cells[0].textContent.trim(),
          cells[1].textContent.trim(),
          cells[2].textContent.trim(),
          cells[3].textContent.trim(),
          cells[4].getAttribute('title') || cells[4].textContent.trim()
        ];
        
        // –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º –∑–∞–ø—è—Ç—ã–µ –∏ –∫–∞–≤—ã—á–∫–∏
        const escapedData = rowData.map(cell => {
          if (cell.includes(',') || cell.includes('"') || cell.includes('\n')) {
            return '"' + cell.replace(/"/g, '""') + '"';
          }
          return cell;
        });
        
        csv += escapedData.join(',') + '\n';
      });
      
      // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
      const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = '–ø—Ä–æ–ø—É—Å–∫–∏_' + new Date().toISOString().split('T')[0] + '.csv';
      link.click();
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      showAlert('–§–∞–π–ª CSV —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω', 'success');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showAlert(message, type = 'info') {
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
      alertDiv.innerHTML = `
        <div class="d-flex align-items-center">
          <span class="me-2">${type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : type === 'danger' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
          <div>${message}</div>
          <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
        </div>
      `;
      
      // –í—Å—Ç–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ç–∞–±–ª–∏—Ü–µ–π
      const table = document.querySelector('.table-responsive');
      if (table) {
        table.parentNode.insertBefore(alertDiv, table);
      } else {
        const containerCard = document.querySelector('.container-card');
        containerCard.insertBefore(alertDiv, containerCard.firstChild);
      }
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        if (alertDiv.parentNode) {
          const bsAlert = new bootstrap.Alert(alertDiv);
          bsAlert.close();
        }
      }, 5000);
    }
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    document.querySelectorAll('tbody tr').forEach(row => {
      row.addEventListener('mouseenter', function() {
        this.style.backgroundColor = 'rgba(0, 115, 230, 0.08)';
        this.style.transition = 'background-color 0.2s ease';
      });
      
      row.addEventListener('mouseleave', function() {
        this.style.backgroundColor = '';
      });
    });
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏
    document.querySelectorAll('.btn-disabled-custom').forEach(btn => {
      btn.addEventListener('click', function(e) {
        if (this.disabled) {
          e.preventDefault();
          e.stopPropagation();
          
          const title = this.getAttribute('title') || '–î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤–∞—à–µ–π —Ä–æ–ª–∏';
          showAlert(title, 'warning');
        }
      });
    });
    
    // –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
    function showAccessTable() {
      const accessTable = `
        <div class="alert alert-info">
          <h6>üìã –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:</h6>
          <table class="table table-sm table-bordered">
            <thead>
              <tr>
                <th>–†–æ–ª—å</th>
                <th>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫</th>
                <th>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫</th>
                <th>–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="badge bg-dark">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span></td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
              </tr>
              <tr>
                <td><span class="badge bg-purple">–ö—É—Ä–∞—Ç–æ—Ä</span></td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
                <td>‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ</td>
              </tr>
              <tr>
                <td><span class="badge bg-success">–°—Ç–∞—Ä–æ—Å—Ç–∞</span></td>
                <td>‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ</td>
                <td>‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ</td>
                <td>‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ</td>
              </tr>
            </tbody>
          </table>
          <small class="text-muted">–≠—Ç–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞ –≤ —Å–∏—Å—Ç–µ–º–µ —É—á–µ—Ç–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤.</small>
        </div>
      `;
      
      showAlert(accessTable, 'info');
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    document.querySelectorAll('.student-name-cell').forEach(cell => {
      cell.style.cursor = 'pointer';
      
      cell.addEventListener('mouseenter', function() {
        this.style.color = '#0073e6';
        this.style.textDecoration = 'underline';
      });
      
      cell.addEventListener('mouseleave', function() {
        this.style.color = '';
        this.style.textDecoration = '';
      });
      
      cell.addEventListener('click', function() {
        const studentName = this.textContent.trim();
        // –ü–æ–ª—É—á–∞–µ–º ID —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
        const row = this.closest('tr');
        const studentId = row.querySelector('.badge-count').textContent.trim();
        showStudentDetails(studentId, studentName);
      });
    });
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–∞–±–ª–∏—Ü–µ
    function setupSearch() {
      const searchInput = document.createElement('input');
      searchInput.type = 'text';
      searchInput.className = 'form-control mb-3';
      searchInput.placeholder = 'üîç –ü–æ–∏—Å–∫ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç—É, –≥—Ä—É–ø–ø–µ –∏–ª–∏ –ø—Ä–∏—á–∏–Ω–µ...';
      searchInput.style.maxWidth = '300px';
      
      const infoPanel = document.querySelector('.text-muted');
      if (infoPanel && infoPanel.parentNode) {
        infoPanel.parentNode.insertBefore(searchInput, infoPanel.nextSibling);
      }
      
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const rows = document.querySelectorAll('tbody tr:not(.no-data)');
        
        let visibleCount = 0;
        
        rows.forEach(row => {
          const name = row.querySelector('.student-name-cell').textContent.toLowerCase();
          const group = row.querySelector('.badge').textContent.toLowerCase();
          const reason = row.querySelector('.reason-cell').textContent.toLowerCase();
          
          if (name.includes(searchTerm) || group.includes(searchTerm) || reason.includes(searchTerm)) {
            row.style.display = '';
            visibleCount++;
          } else {
            row.style.display = 'none';
          }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
        const counter = document.querySelector('.badge.bg-primary.rounded-pill');
        if (counter) {
          counter.textContent = visibleCount;
        }
      });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏
    {% if absences and absences|length > 0 %}
    setTimeout(setupSearch, 500);
    {% endif %}
  </script>
</body>
</html>